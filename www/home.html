<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
	<meta name="viewport" content="width=device-width, height=device-height, user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, target-densitydpi=medium-dpi" />
    
	<link href="lib/jqm/1.4.5/jquery.mobile-1.3.0-beta.1.css" rel="stylesheet" />
    <link href="css/themes/2/jquery.mobile.icons.min.css" rel="stylesheet" />
    <link href="lib/jqm/1.4.5/jquery.mobile.structure-1.4.5.min.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="css/app.css" />
	<link rel="stylesheet" type="text/css" href="css/jqm-icon-pack-fa.css" />
    <title>IITSO Voting System</title>
	<style>
		/* Swipe works with mouse as well but often causes text selection. */
		#demo-page * {
			-webkit-user-select: none;
			-moz-user-select: none;
			-ms-user-select: none;
			-o-user-select: none;
			user-select: none;
		}
		/* Arrow only buttons in the header. */
		#demo-page .ui-header .ui-btn {
			background: none;
			border: none;
			top: 9px;
		}
		#demo-page .ui-header .ui-btn-inner {
			border: none;
		}
		/* Content styling. */
		dl { font-family: "Times New Roman", Times, serif; padding: 1em; }
		dt { font-size: 2em; font-weight: bold; }
		dt span { font-size: .5em; color: #777; margin-left: .5em; }
		dd { font-size: 1.25em;	margin: 1em 0 0; padding-bottom: 1em; border-bottom: 1px solid #eee; }
		.back-btn { float: right; margin: 0 2em 1em 0; }
	</style>
	<style>
		.button-fit:focus {
			-moz-box-shadow: inset 0 0 3px red  , 0 0 9px red !important;
			-webkit-box-shadow: inset 0 0 3px red  , 0 0 9px red !important;
			box-shadow: inset 0 0 3px red  , 0 0 9px red !important;
		}
	</style>
</head>
<body>

	<div data-role="page" data-theme="d" id="page-index">

		<div data-role="header" data-theme="d">
			<a href="#nav-panel" data-icon="bars" data-iconpos="notext" data-theme="d" data-shadow="false" data-iconshadow="false" class="ui-icon-nodisc">Menu</a>
		</div>

		<div data-role="content" role="main" class="ui-content">
			<img src="img/main.png" class="logo4" />
			<div class="content-primary4">
				<center><h1>Click here to vote</h1></center>
				<a href="#page-vote" onclick="checkelectionstatus()" class="ui-btn ui-btn-b button-fit ui-corner-all" style="background-color: black;color: white;text-decoration: none;">VOTE</a>
			</div>
		</div>

		<div data-role="panel" data-position-fixed="true" data-display="push" data-theme="b" id="nav-panel">
			<ul data-role="listview">
					<li style="height: 150px;">
						<img src="img/logo_ver2.png" style="margin-left: auto;margin-right: auto;position: static;width: 51%;" class="logo" />
					</li>
					<li><a href="#page-vote">Vote Now!</a></li>
					<li><a href="#page-candidate" onclick="fetchcandidate()">Candidates</a></li>
					<li><a href="#page-contacts">Contacts</a></li>
					<li><a href="#page-about">About</a></li>
					<li><a onclick="logout()">Logout</a></li>
			</ul>
		</div>
	</div>
	
	<div data-role="page" data-theme="d" id="page-about">

		<div data-role="header" data-theme="d">
			<a href="#nav-panel" data-icon="bars" data-iconpos="notext" data-theme="d" data-shadow="false" data-iconshadow="false" class="ui-icon-nodisc">Menu</a>
		</div>

		<div data-role="content" role="main" class="ui-content">
			<img src="img/about.png" class="logo4" />
			<div class="content-primary4">
				<center><h3>Manilyn Gubaton</h3></center>
				<center><h3>Shairah Mae Dinaga</h3></center>
				<center><h3>Mary Claire Visca</h3></center>
				<center><h3>Livy May Abao</h3></center>
				<center><h3>Rey Mark Calay</h3></center>
			</div>
		</div>

		<div data-role="panel" data-position-fixed="true" data-display="push" data-theme="b" id="nav-panel">
			<ul data-role="listview">
					<li style="height: 150px;">
						<img src="img/logo_ver2.png" style="margin-left: auto;margin-right: auto;position: static;width: 51%;" class="logo" />
					</li>
					<li><a href="#page-vote">Vote Now!</a></li>
					<li><a href="#page-candidate" onclick="fetchcandidate()">Candidates</a></li>
					<li><a href="#page-contacts">Contacts</a></li>
					<li><a href="#page-about" data-rel="close">About</a></li>
					<li><a onclick="logout()">Logout</a></li>
			</ul>
		</div>
	</div>
	
	<div data-role="page" data-theme="d" id="page-contacts">

		<div data-role="header" data-theme="d">
			<a href="#nav-panel" data-icon="bars" data-iconpos="notext" data-theme="d" data-shadow="false" data-iconshadow="false" class="ui-icon-nodisc">Menu</a>
		</div>

		<div data-role="content" role="main" class="ui-content">
			<img src="img/contacts.png" class="logo4" />
			<div class="content-primary4">
				<center><h3>iitso.voting.system@android.com</h3></center>
			</div>
		</div>

		<div data-role="panel" data-position-fixed="true" data-display="push" data-theme="b" id="nav-panel">
			<ul data-role="listview">
					<li style="height: 150px;">
						<img src="img/logo_ver2.png" style="margin-left: auto;margin-right: auto;position: static;width: 51%;" class="logo" />
					</li>
					<li><a href="#page-vote">Vote Now!</a></li>
					<li><a href="#page-candidate" onclick="fetchcandidate()">Candidates</a></li>
					<li><a href="#page-contacts" data-rel="close">Contacts</a></li>
					<li><a href="#page-about">About</a></li>
					<li><a onclick="logout()">Logout</a></li>
			</ul>
		</div>
	</div>
	
	<div data-role="page" data-theme="d" id="page-candidate">

		<div data-role="header" data-theme="d">
			<a href="#nav-panel" data-icon="bars" data-iconpos="notext" data-theme="d" data-shadow="false" data-iconshadow="false" class="ui-icon-nodisc">Menu</a>
		</div>

		<div data-role="content" role="main" class="ui-content">
			<img src="img/candidates.png" class="logo4" />
			<div class="content-primary4" id="selectdiv2">
				<table data-role="table" id="table-column-toggle" data-mode="columntoggle" class="ui-responsive table-stroke">
					<thead>
						<tr>
							<th data-priority="2">Position</th>
							<th>Name</th>
							<th data-priority="3">Year</th>
							<th data-priority="1">Block</th>
						</tr>
					</thead>
					<tbody>
						
					</tbody>
				</table>
			</div>
		</div>

		<div data-role="panel" data-position-fixed="true" data-display="push" data-theme="b" id="nav-panel">
			<ul data-role="listview">
					<li style="height: 150px;">
						<img src="img/logo_ver2.png" style="margin-left: auto;margin-right: auto;position: static;width: 51%;" class="logo" />
					</li>
					<li><a href="#page-vote">Vote Now!</a></li>
					<li><a href="#page-candidate" data-rel="close" onclick="fetchcandidate()">Candidates</a></li>
					<li><a href="#page-contacts">Contacts</a></li>
					<li><a href="#page-about">About</a></li>
					<li><a onclick="logout()">Logout</a></li>
			</ul>
		</div>
	</div>
	
	<div data-role="page" data-theme="d" id="page-vote">

		<div data-role="header" data-theme="d">
			<a href="#nav-panel" data-icon="bars" data-iconpos="notext" data-theme="d" data-shadow="false" data-iconshadow="false" class="ui-icon-nodisc">Menu</a>
		</div>

		<div data-role="content" role="main" class="ui-content">
			<img src="img/vote.png" class="logo4" />
				<form>
					<div class="content-primary4 ui-field-contain" id="selectdiv">
						<input type="hidden" name="idhidden" id="idhidden"/>
					</div>
					<input type="button" name="submit" id="submit" value="SUBMIT" />
				</form>
		</div>

		<div data-role="panel" data-position-fixed="true" data-display="push" data-theme="b" id="nav-panel">
			<ul data-role="listview">
					<li style="height: 150px;">
						<img src="img/logo_ver2.png" style="margin-left: auto;margin-right: auto;position: static;width: 51%;" class="logo" />
					</li>
					<li><a href="#page-vote" data-rel="close">Vote Now!</a></li>
					<li><a href="#page-candidate" onclick="fetchcandidate()">Candidates</a></li>
					<li><a href="#page-contacts">Contacts</a></li>
					<li><a href="#page-about">About</a></li>
					<li><a onclick="logout()">Logout</a></li>
			</ul>
		</div>
	</div>
 
    <script src="lib/fastclick/fastclick.min.js"></script>
    <script src="lib/jquery/2.1.1/jquery-1.7.1.min.js"></script>
    <script src="js/settings.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
    <script src="lib/jqm/1.4.5/jquery.mobile-1.3.0-beta.1.js"></script>
	
	<script>
		var value = window.sessionStorage.getItem("name");
		var id = window.sessionStorage.getItem("id");
		$("#idhidden").val(id);
		
		if (value == null){
			window.location = "index.html";
		}
		
		function logout(){
			var r = confirm("Do you want to logout?");
			if (r == true) {
				window.sessionStorage.removeItem("name");
				window.location = "index.html";
			}
		}
		
		function checkelectionstatus(){
			$.ajax({
				url: 'http://rsusupplyinventory.com/checkResultStatus.php',
				type: 'post',
				//data: {id:id},
				dataType: 'json',
				success:function(response){
					if (response[0].flag == 1){
						alert("Message: No active IITSO election!");
						window.location.href = "#page-index";
					}
				}
			});
		}
		
		$(function () {
			$( "#submit" ).click(function(e) {
				e.preventDefault();
				
				$.ajax({
					url: 'http://rsusupplyinventory.com/checkResultStatus.php',
					type: 'post',
					//data: {id:id},
					dataType: 'json',
					success:function(response){
						if (response[0].flag == 1){
							alert("Message: No active IITSO election!");
							window.location.href = "#page-index";
						}else{
							var r = confirm("Do you want to submit your votes?");
							if (r == true){
								$.ajax({
									url: 'http://rsusupplyinventory.com/PostSubmit.php',
									type: 'post',
									data: $("form").serialize(),
									//dataType: 'json',
									success: function (data) {
										alert("Your vote counts! Thank you!");
										window.sessionStorage.removeItem("name");
										window.location = "index.html";
									}
								 });
							}
						}
					}
				});
			})
		})
		
		function fetchcandidate(){
			$("#table-column-toggle tbody tr").remove();
			$.ajax({
				url: 'http://rsusupplyinventory.com/getCandidatesAll.php',
				type: 'post',
				//data: {id:id},
				dataType: 'json',
				success:function(response){
					
					//Create and append the options
					for (var i = 0; i < response.length; i++) {
					
						$('#table-column-toggle > tbody:last-child').append(
						'<tr>'// need to change closing tag to an opening `<tr>` tag.
						+'<td>'+response[i].pos+'</td>'
						+'<td>'+response[i].name+'</td>'
						+'<td>'+response[i].year+'</td>'
						+'<td>'+response[i].block+'</td>'
						+'</tr>');
					
					}
				}});
		}
		
		$(document).ready(function(){
			$.ajax({
				url: 'http://rsusupplyinventory.com/getPosition.php',
				type: 'get',
				//data: {depart:deptid},
				dataType: 'json',
				success:function(response){
					var len = response.length;
					
					for( var i = 0; i<len; i++){
						var id = response[i]['id'];
						var positionname = response[i]['position_name'];
						
						//alert("Data Loading....");
						
						$.ajax({
						url: 'http://rsusupplyinventory.com/getCandidates.php',
						type: 'post',
						data: {id:id},
						dataType: 'json',
						success:function(response){
						
							if (response.length != 0){
						
								var myDiv = document.getElementById("selectdiv");

								//Create and append select list
								var selectList = document.createElement("select");
								//selectList.setAttribute("id", "select-native-1");
								selectList.setAttribute("name", "selcandidates[]");
								selectList.setAttribute("style", "width:100%; height:80px;font-size:18px;");
								//id + $('select').size()
								
								var br = document.createElement("br");
								myDiv.appendChild(br);
								var br2 = document.createElement("br");
								myDiv.appendChild(br2);
								
								myDiv.appendChild(selectList);
								
								var optiondef = document.createElement("option");

								//Create and append the options
								for (var i = 0; i < response.length; i++) {
								
									/*if (i == 0){
										var header = document.getElementById("selectdiv"),
										h4 = document.createElement("h4");
										h4.setAttribute("id", "myH4");

										h4.textContent = response[i].pos;
										header.appendChild(h4);
									}*/
								
									var option = document.createElement("option");
									option.setAttribute("value", response[i].id);
									option.text = response[i].pos + ": " + response[i].name;
									selectList.appendChild(option);
									
									if (i < response.length){
										optiondef.setAttribute("selected", "selected");
										//optiondef.setAttribute("disabled", "disabled");
										optiondef.setAttribute("value", "0");
										optiondef.text = "Choose your " + response[i].pos;
										selectList.insertBefore(optiondef, selectList.childNodes[0]);
									}
								}
							}
						}});
					}
				}
			});
		});
	</script>
</body>
</html>
